T2_Table4$X11 <- as.numeric(as.character(T2_Table4$X11))
View(T2_Table4)
plot(T2_Table4$X3,T2_Table4$X6)
T2_Table3 <-Filter(length, T2_Table2)
T2_Table4 <- data.frame(t(sapply(T2_Table3,c)))
T2_Table4$X1 <- as.character(T2_Table4$X1)
T2_Table4$X2 <- as.character(T2_Table4$X2)
T2_Table4$X3 <- as.numeric(as.character(T2_Table4$X3))
T2_Table4$X4 <- as.numeric(as.character(T2_Table4$X4))
T2_Table4$X8 <- as.numeric(as.character(T2_Table4$X8))
T2_Table4$X5 <- as.numeric(as.character(T2_Table4$X5))
T2_Table4$X6 <- as.numeric(as.character(T2_Table4$X6))
T2_Table4$X9 <- as.numeric(as.character(T2_Table4$X9))
T2_Table4$X10 <- as.numeric(as.character(T2_Table4$X10))
T2_Table4$X11 <- as.numeric(as.character(T2_Table4$X11))
plot(T2_Table4$X3,T2_Table4$X6)
View(T2_Table4)
T2_Similarity <- read.table(file="data/TCS_Weighted_SR.txt",row.names=1,header=TRUE,check.names = FALSE)
T2_Similarity <- as.matrix(T2_Similarity)
H <- T2_Similarity[1:10,1:10]
View(H)
Start.time <- Sys.time()
T2_Table2 <- apply(t2_comb1,1,function(t2_x){
t2_fl_1 <- as.character(unlist(t2_x[1]))
t2_fl_2 <- as.character(unlist(t2_x[2]))
t2_dr_1 <- as.character(T2_TCS_Flavor_Metadata[which(T2_TCS_Flavor_Metadata$FL_IDs==t2_fl_1),"Drug"])
t2_dr_2 <- as.character(T2_TCS_Flavor_Metadata[which(T2_TCS_Flavor_Metadata$FL_IDs==t2_fl_2),"Drug"])
t2_sim <- T2_Similarity[t2_dr_1,t2_dr_2]
t2_sig1 <- unlist(T2_TCS_Flavors3[t2_fl_1,])
t2_sig2 <- unlist(T2_TCS_Flavors3[t2_fl_2,])
t2_p <- t2_sig1*t2_sig2
#Drug1
t2_sig1[names(t2_p[t2_p<0])] <- 0
ts_drug1 <- T2_Disease_Sig3*t2_sig1
t2_drug1_a <- length(ts_drug1[ts_drug1<0])
#t2_drug1_a <- sum(abs(T2_Disease_Sig3[ts_drug1<0]))
t2_drug1_b <- length(ts_drug1[ts_drug1>0])
#t2_drug1_b <- sum(abs(T2_Disease_Sig3[ts_drug1>0]))
if (t2_drug1_b==0) { t2_drug1_b<-1}
t2_drug1_c <- t2_drug1_a/t2_drug1_b
t2_drug1_d <- t2_drug1_c *t2_drug1_a
#Drug2
t2_sig2[names(t2_p[t2_p<0])] <- 0
ts_drug2 <- T2_Disease_Sig3*t2_sig2
t2_drug2_a <- length(ts_drug2[ts_drug2<0])
#t2_drug2_a <- sum(abs(T2_Disease_Sig3[ts_drug2<0]))
t2_drug2_b <- length(ts_drug2[ts_drug2>0])
#t2_drug2_b <- sum(abs(T2_Disease_Sig3[ts_drug2>0]))
if (t2_drug2_b==0) { t2_drug2_b<-1}
t2_drug2_c <- t2_drug2_a/t2_drug2_b
t2_drug2_d <- t2_drug2_c * t2_drug2_a
t2_sum <- t2_drug2_a+t2_drug2_a
t2_mean <- mean(c(t2_drug1_c,t2_drug2_c))
t2_mean2 <- mean(c(t2_drug1_d,t2_drug2_d))
if(t2_drug1_c>2 & t2_drug2_c > 2 & t2_drug1_a>20 & t2_drug2_a>20 )
{
return(c(t2_fl_1,t2_fl_2,t2_sim,t2_drug1_c,t2_drug2_c,t2_mean,t2_drug1_a,t2_drug2_a,t2_sum,t2_drug1_d,t2_drug2_d,t2_mean2))
}
})
End.time <- Sys.time()
End.time-Start.time
T2_Table3 <-Filter(length, T2_Table2)
T2_Table4 <- data.frame(t(sapply(T2_Table3,c)))
T2_Table4$X1 <- as.character(T2_Table4$X1)
T2_Table4$X2 <- as.character(T2_Table4$X2)
T2_Table4$X3 <- as.numeric(as.character(T2_Table4$X3))
T2_Table4$X4 <- as.numeric(as.character(T2_Table4$X4))
T2_Table4$X8 <- as.numeric(as.character(T2_Table4$X8))
T2_Table4$X5 <- as.numeric(as.character(T2_Table4$X5))
T2_Table4$X6 <- as.numeric(as.character(T2_Table4$X6))
T2_Table4$X9 <- as.numeric(as.character(T2_Table4$X9))
T2_Table4$X10 <- as.numeric(as.character(T2_Table4$X10))
T2_Table4$X11 <- as.numeric(as.character(T2_Table4$X11))
View(T2_Table4)
t2_fl_1 <- "alisertib$FL1"
t2_fl_2 <- "GSK-1070916$FL2"
t2_dr_1 <- as.character(T2_TCS_Flavor_Metadata[which(T2_TCS_Flavor_Metadata$FL_IDs==t2_fl_1),"Drug"])
t2_dr_2 <- as.character(T2_TCS_Flavor_Metadata[which(T2_TCS_Flavor_Metadata$FL_IDs==t2_fl_2),"Drug"])
t2_sim <- T2_Similarity[t2_dr_1,t2_dr_2]
t2_sig1 <- unlist(T2_TCS_Flavors3[t2_fl_1,])
t2_sig2 <- unlist(T2_TCS_Flavors3[t2_fl_2,])
t2_p <- t2_sig1*t2_sig2
#Drug1
t2_sig1[names(t2_p[t2_p<0])] <- 0
ts_drug1 <- T2_Disease_Sig3*t2_sig1
t2_drug1_a <- length(ts_drug1[ts_drug1<0])
#t2_drug1_a <- sum(abs(T2_Disease_Sig3[ts_drug1<0]))
t2_drug1_b <- length(ts_drug1[ts_drug1>0])
#t2_drug1_b <- sum(abs(T2_Disease_Sig3[ts_drug1>0]))
if (t2_drug1_b==0) { t2_drug1_b<-1}
t2_drug1_c <- t2_drug1_a/t2_drug1_b
t2_drug1_d <- t2_drug1_c *t2_drug1_a
#Drug2
t2_sig2[names(t2_p[t2_p<0])] <- 0
ts_drug2 <- T2_Disease_Sig3*t2_sig2
t2_drug2_a <- length(ts_drug2[ts_drug2<0])
#t2_drug2_a <- sum(abs(T2_Disease_Sig3[ts_drug2<0]))
t2_drug2_b <- length(ts_drug2[ts_drug2>0])
#t2_drug2_b <- sum(abs(T2_Disease_Sig3[ts_drug2>0]))
if (t2_drug2_b==0) { t2_drug2_b<-1}
t2_drug2_c <- t2_drug2_a/t2_drug2_b
t2_drug2_d <- t2_drug2_c * t2_drug2_a
t2_sum <- t2_drug2_a+t2_drug2_a
t2_mean <- mean(c(t2_drug1_c,t2_drug2_c))
t2_mean2 <- mean(c(t2_drug1_d,t2_drug2_d))
t2_drug1_c
return(c(t2_fl_1,t2_fl_2,t2_sim,t2_drug1_c,t2_drug2_c,t2_mean,t2_drug1_a,t2_drug2_a,t2_sum,t2_drug1_d,t2_drug2_d,t2_mean2))
t2_fl_1,t2_fl_2,t2_sim,t2_drug1_c,t2_drug2_c,t2_mean,t2_drug1_a,t2_drug2_a,t2_sum,t2_drug1_d,t2_drug2_d,t2_mean2)
c(t2_fl_1,t2_fl_2,t2_sim,t2_drug1_c,t2_drug2_c,t2_mean,t2_drug1_a,t2_drug2_a,t2_sum,t2_drug1_d,t2_drug2_d,t2_mean2)
t2_sig1
t2_sig2
t2_p
t2_mean
t2_mean
Start.time <- Sys.time()
T2_Table2 <- apply(t2_comb1,1,function(t2_x){
t2_fl_1 <- as.character(unlist(t2_x[1]))
t2_fl_2 <- as.character(unlist(t2_x[2]))
t2_dr_1 <- as.character(T2_TCS_Flavor_Metadata[which(T2_TCS_Flavor_Metadata$FL_IDs==t2_fl_1),"Drug"])
t2_dr_2 <- as.character(T2_TCS_Flavor_Metadata[which(T2_TCS_Flavor_Metadata$FL_IDs==t2_fl_2),"Drug"])
t2_sim <- T2_Similarity[t2_dr_1,t2_dr_2]
t2_sig1 <- unlist(T2_TCS_Flavors3[t2_fl_1,])
t2_sig2 <- unlist(T2_TCS_Flavors3[t2_fl_2,])
t2_p <- t2_sig1*t2_sig2
#Drug1
t2_sig1[names(t2_p[t2_p<0])] <- 0
ts_drug1 <- T2_Disease_Sig3*t2_sig1
t2_drug1_a <- length(ts_drug1[ts_drug1<0])
#t2_drug1_a <- sum(abs(T2_Disease_Sig3[ts_drug1<0]))
t2_drug1_b <- length(ts_drug1[ts_drug1>0])
#t2_drug1_b <- sum(abs(T2_Disease_Sig3[ts_drug1>0]))
if (t2_drug1_b==0) { t2_drug1_b<-1}
t2_drug1_c <- t2_drug1_a/t2_drug1_b
t2_drug1_d <- t2_drug1_c *t2_drug1_a
#Drug2
t2_sig2[names(t2_p[t2_p<0])] <- 0
ts_drug2 <- T2_Disease_Sig3*t2_sig2
t2_drug2_a <- length(ts_drug2[ts_drug2<0])
#t2_drug2_a <- sum(abs(T2_Disease_Sig3[ts_drug2<0]))
t2_drug2_b <- length(ts_drug2[ts_drug2>0])
#t2_drug2_b <- sum(abs(T2_Disease_Sig3[ts_drug2>0]))
if (t2_drug2_b==0) { t2_drug2_b<-1}
t2_drug2_c <- t2_drug2_a/t2_drug2_b
t2_drug2_d <- t2_drug2_c * t2_drug2_a
t2_sum <- t2_drug2_a+t2_drug2_a
t2_mean <- mean(c(t2_drug1_c,t2_drug2_c))
t2_mean2 <- mean(c(t2_drug1_d,t2_drug2_d))
if(t2_drug1_c>2 & t2_drug2_c > 2 & t2_drug1_a>20 & t2_drug2_a>20 )
{
return(c(t2_fl_1,t2_fl_2,t2_sim,t2_drug1_c,t2_drug2_c,t2_mean,t2_drug1_a,t2_drug2_a,t2_sum,t2_drug1_d,t2_drug2_d,t2_mean2))
}
})
End.time <- Sys.time()
End.time-Start.time
T2_Table3 <-Filter(length, T2_Table2)
T2_Table4 <- data.frame(t(sapply(T2_Table3,c)))
T2_Table4$X1 <- as.character(T2_Table4$X1)
T2_Table4$X2 <- as.character(T2_Table4$X2)
T2_Table4$X3 <- as.numeric(as.character(T2_Table4$X3))
T2_Table4$X4 <- as.numeric(as.character(T2_Table4$X4))
T2_Table4$X8 <- as.numeric(as.character(T2_Table4$X8))
T2_Table4$X5 <- as.numeric(as.character(T2_Table4$X5))
T2_Table4$X6 <- as.numeric(as.character(T2_Table4$X6))
T2_Table4$X9 <- as.numeric(as.character(T2_Table4$X9))
T2_Table4$X10 <- as.numeric(as.character(T2_Table4$X10))
T2_Table4$X11 <- as.numeric(as.character(T2_Table4$X11))
### STEP2. Filter for Drugs that have a DR > 2
T2_Drugs2 <- unique(as.character(T2_Disc_Ratio2[which(T2_Disc_Ratio2$DR>=2),"Drug"]))
T2_Drugs2 <- intersect(T2_Drugs2,colnames(T2_Similarity))
T2_Table1 <- data.frame()
for (t2_drug in T2_Drugs2)
{
t2_1 <- T2_Disc_Ratio2[which(T2_Disc_Ratio2$Drug==t2_drug),]
t2_2 <- t2_1[order(t2_1$DR,decreasing=TRUE),]
t2_3 <- as.character(t2_2[1,"Row.names"])
t2_4 <- as.numeric(as.character(t2_2[1,"DR"]))
t2_vec <- c(t2_drug,t2_3,t2_4)
T2_Table1 <- rbind(T2_Table1,t2_vec,stringsAsFactors=FALSE)
}
T2_Table1 <- T2_Disc_Ratio2[which(T2_Disc_Ratio2$DR >=2),c("Drug","Row.names","DR")]
colnames(T2_Table1) <- c("Drug","Flavor","DR")
t2_comb1 <- t(combn(as.character(T2_Table1$Flavor),2))
T2_TCS_Flavors3 <- as.matrix(T2_TCS_Flavors2)
T2_TCS_Flavors3[abs(T2_TCS_Flavors3)==1] <-0
Start.time <- Sys.time()
T2_Table2 <- apply(t2_comb1,1,function(t2_x){
t2_fl_1 <- as.character(unlist(t2_x[1]))
t2_fl_2 <- as.character(unlist(t2_x[2]))
t2_dr_1 <- as.character(T2_TCS_Flavor_Metadata[which(T2_TCS_Flavor_Metadata$FL_IDs==t2_fl_1),"Drug"])
t2_dr_2 <- as.character(T2_TCS_Flavor_Metadata[which(T2_TCS_Flavor_Metadata$FL_IDs==t2_fl_2),"Drug"])
t2_sim <- T2_Similarity[t2_dr_1,t2_dr_2]
t2_sig1 <- unlist(T2_TCS_Flavors3[t2_fl_1,])
t2_sig2 <- unlist(T2_TCS_Flavors3[t2_fl_2,])
t2_p <- t2_sig1*t2_sig2
#Drug1
t2_sig1[names(t2_p[t2_p<0])] <- 0
ts_drug1 <- T2_Disease_Sig3*t2_sig1
t2_drug1_a <- length(ts_drug1[ts_drug1<0])
#t2_drug1_a <- sum(abs(T2_Disease_Sig3[ts_drug1<0]))
t2_drug1_b <- length(ts_drug1[ts_drug1>0])
#t2_drug1_b <- sum(abs(T2_Disease_Sig3[ts_drug1>0]))
if (t2_drug1_b==0) { t2_drug1_b<-1}
t2_drug1_c <- t2_drug1_a/t2_drug1_b
t2_drug1_d <- t2_drug1_c *t2_drug1_a
#Drug2
t2_sig2[names(t2_p[t2_p<0])] <- 0
ts_drug2 <- T2_Disease_Sig3*t2_sig2
t2_drug2_a <- length(ts_drug2[ts_drug2<0])
#t2_drug2_a <- sum(abs(T2_Disease_Sig3[ts_drug2<0]))
t2_drug2_b <- length(ts_drug2[ts_drug2>0])
#t2_drug2_b <- sum(abs(T2_Disease_Sig3[ts_drug2>0]))
if (t2_drug2_b==0) { t2_drug2_b<-1}
t2_drug2_c <- t2_drug2_a/t2_drug2_b
t2_drug2_d <- t2_drug2_c * t2_drug2_a
t2_sum <- t2_drug2_a+t2_drug2_a
t2_mean <- mean(c(t2_drug1_c,t2_drug2_c))
t2_mean2 <- mean(c(t2_drug1_d,t2_drug2_d))
if(t2_drug1_c>2 & t2_drug2_c > 2 & t2_drug1_a>20 & t2_drug2_a>20 )
{
return(c(t2_fl_1,t2_fl_2,t2_sim,t2_drug1_c,t2_drug2_c,t2_mean,t2_drug1_a,t2_drug2_a,t2_sum,t2_drug1_d,t2_drug2_d,t2_mean2))
}
})
End.time <- Sys.time()
End.time-Start.time
T2_Table3 <-Filter(length, T2_Table2)
T2_Table4 <- data.frame(t(sapply(T2_Table3,c)))
T2_Table4$X1 <- as.character(T2_Table4$X1)
T2_Table4$X2 <- as.character(T2_Table4$X2)
T2_Table4$X3 <- as.numeric(as.character(T2_Table4$X3))
T2_Table4$X4 <- as.numeric(as.character(T2_Table4$X4))
T2_Table4$X8 <- as.numeric(as.character(T2_Table4$X8))
T2_Table4$X5 <- as.numeric(as.character(T2_Table4$X5))
T2_Table4$X6 <- as.numeric(as.character(T2_Table4$X6))
T2_Table4$X9 <- as.numeric(as.character(T2_Table4$X9))
T2_Table4$X10 <- as.numeric(as.character(T2_Table4$X10))
T2_Table4$X11 <- as.numeric(as.character(T2_Table4$X11))
colnames(T2_Similarity)
row.names(T2_Similarity)
setdiff(colnames(T2_Similarity),row.names(T2_Similarity))
I <- intersect(colnames(T2_Similarity),row.names(T2_Similarity))
T2_Drugs2 <- intersect(T2_Drugs2,I)
T2_Table1 <- data.frame()
for (t2_drug in T2_Drugs2)
{
t2_1 <- T2_Disc_Ratio2[which(T2_Disc_Ratio2$Drug==t2_drug),]
t2_2 <- t2_1[order(t2_1$DR,decreasing=TRUE),]
t2_3 <- as.character(t2_2[1,"Row.names"])
t2_4 <- as.numeric(as.character(t2_2[1,"DR"]))
t2_vec <- c(t2_drug,t2_3,t2_4)
T2_Table1 <- rbind(T2_Table1,t2_vec,stringsAsFactors=FALSE)
}
T2_Table1 <- T2_Disc_Ratio2[which(T2_Disc_Ratio2$DR >=2),c("Drug","Row.names","DR")]
colnames(T2_Table1) <- c("Drug","Flavor","DR")
t2_comb1 <- t(combn(as.character(T2_Table1$Flavor),2))
T2_TCS_Flavors3 <- as.matrix(T2_TCS_Flavors2)
T2_TCS_Flavors3[abs(T2_TCS_Flavors3)==1] <-0
Start.time <- Sys.time()
T2_Table2 <- apply(t2_comb1,1,function(t2_x){
t2_fl_1 <- as.character(unlist(t2_x[1]))
t2_fl_2 <- as.character(unlist(t2_x[2]))
t2_dr_1 <- as.character(T2_TCS_Flavor_Metadata[which(T2_TCS_Flavor_Metadata$FL_IDs==t2_fl_1),"Drug"])
t2_dr_2 <- as.character(T2_TCS_Flavor_Metadata[which(T2_TCS_Flavor_Metadata$FL_IDs==t2_fl_2),"Drug"])
t2_sim <- T2_Similarity[t2_dr_1,t2_dr_2]
t2_sig1 <- unlist(T2_TCS_Flavors3[t2_fl_1,])
t2_sig2 <- unlist(T2_TCS_Flavors3[t2_fl_2,])
t2_p <- t2_sig1*t2_sig2
#Drug1
t2_sig1[names(t2_p[t2_p<0])] <- 0
ts_drug1 <- T2_Disease_Sig3*t2_sig1
t2_drug1_a <- length(ts_drug1[ts_drug1<0])
#t2_drug1_a <- sum(abs(T2_Disease_Sig3[ts_drug1<0]))
t2_drug1_b <- length(ts_drug1[ts_drug1>0])
#t2_drug1_b <- sum(abs(T2_Disease_Sig3[ts_drug1>0]))
if (t2_drug1_b==0) { t2_drug1_b<-1}
t2_drug1_c <- t2_drug1_a/t2_drug1_b
t2_drug1_d <- t2_drug1_c *t2_drug1_a
#Drug2
t2_sig2[names(t2_p[t2_p<0])] <- 0
ts_drug2 <- T2_Disease_Sig3*t2_sig2
t2_drug2_a <- length(ts_drug2[ts_drug2<0])
#t2_drug2_a <- sum(abs(T2_Disease_Sig3[ts_drug2<0]))
t2_drug2_b <- length(ts_drug2[ts_drug2>0])
#t2_drug2_b <- sum(abs(T2_Disease_Sig3[ts_drug2>0]))
if (t2_drug2_b==0) { t2_drug2_b<-1}
t2_drug2_c <- t2_drug2_a/t2_drug2_b
t2_drug2_d <- t2_drug2_c * t2_drug2_a
t2_sum <- t2_drug2_a+t2_drug2_a
t2_mean <- mean(c(t2_drug1_c,t2_drug2_c))
t2_mean2 <- mean(c(t2_drug1_d,t2_drug2_d))
if(t2_drug1_c>2 & t2_drug2_c > 2 & t2_drug1_a>20 & t2_drug2_a>20 )
{
return(c(t2_fl_1,t2_fl_2,t2_sim,t2_drug1_c,t2_drug2_c,t2_mean,t2_drug1_a,t2_drug2_a,t2_sum,t2_drug1_d,t2_drug2_d,t2_mean2))
}
})
End.time <- Sys.time()
End.time-Start.time
T2_Table3 <-Filter(length, T2_Table2)
T2_Table4 <- data.frame(t(sapply(T2_Table3,c)))
T2_Table4$X1 <- as.character(T2_Table4$X1)
T2_Table4$X2 <- as.character(T2_Table4$X2)
T2_Table4$X3 <- as.numeric(as.character(T2_Table4$X3))
T2_Table4$X4 <- as.numeric(as.character(T2_Table4$X4))
T2_Table4$X8 <- as.numeric(as.character(T2_Table4$X8))
T2_Table4$X5 <- as.numeric(as.character(T2_Table4$X5))
T2_Table4$X6 <- as.numeric(as.character(T2_Table4$X6))
T2_Table4$X9 <- as.numeric(as.character(T2_Table4$X9))
T2_Table4$X10 <- as.numeric(as.character(T2_Table4$X10))
T2_Table4$X11 <- as.numeric(as.character(T2_Table4$X11))
isSymmetric(T2_Similarity)
Start.time <- Sys.time()
T2_Table2 <- apply(t2_comb1,1,function(t2_x){
t2_fl_1 <- as.character(unlist(t2_x[1]))
t2_fl_2 <- as.character(unlist(t2_x[2]))
t2_dr_1 <- as.character(T2_TCS_Flavor_Metadata[which(T2_TCS_Flavor_Metadata$FL_IDs==t2_fl_1),"Drug"])
t2_dr_2 <- as.character(T2_TCS_Flavor_Metadata[which(T2_TCS_Flavor_Metadata$FL_IDs==t2_fl_2),"Drug"])
if (t2_dr_1 %in% row.names(T2_Similarity) & t2_dr_2 %in% colnames(T2_Similarity))
{
t2_sim <- T2_Similarity[t2_dr_1,t2_dr_2]
t2_sig1 <- unlist(T2_TCS_Flavors3[t2_fl_1,])
t2_sig2 <- unlist(T2_TCS_Flavors3[t2_fl_2,])
t2_p <- t2_sig1*t2_sig2
#Drug1
t2_sig1[names(t2_p[t2_p<0])] <- 0
ts_drug1 <- T2_Disease_Sig3*t2_sig1
t2_drug1_a <- length(ts_drug1[ts_drug1<0])
#t2_drug1_a <- sum(abs(T2_Disease_Sig3[ts_drug1<0]))
t2_drug1_b <- length(ts_drug1[ts_drug1>0])
#t2_drug1_b <- sum(abs(T2_Disease_Sig3[ts_drug1>0]))
if (t2_drug1_b==0) { t2_drug1_b<-1}
t2_drug1_c <- t2_drug1_a/t2_drug1_b
t2_drug1_d <- t2_drug1_c *t2_drug1_a
#Drug2
t2_sig2[names(t2_p[t2_p<0])] <- 0
ts_drug2 <- T2_Disease_Sig3*t2_sig2
t2_drug2_a <- length(ts_drug2[ts_drug2<0])
#t2_drug2_a <- sum(abs(T2_Disease_Sig3[ts_drug2<0]))
t2_drug2_b <- length(ts_drug2[ts_drug2>0])
#t2_drug2_b <- sum(abs(T2_Disease_Sig3[ts_drug2>0]))
if (t2_drug2_b==0) { t2_drug2_b<-1}
t2_drug2_c <- t2_drug2_a/t2_drug2_b
t2_drug2_d <- t2_drug2_c * t2_drug2_a
t2_sum <- t2_drug2_a+t2_drug2_a
t2_mean <- mean(c(t2_drug1_c,t2_drug2_c))
t2_mean2 <- mean(c(t2_drug1_d,t2_drug2_d))
if(t2_drug1_c>2 & t2_drug2_c > 2 & t2_drug1_a>20 & t2_drug2_a>20 )
{
return(c(t2_fl_1,t2_fl_2,t2_sim,t2_drug1_c,t2_drug2_c,t2_mean,t2_drug1_a,t2_drug2_a,t2_sum,t2_drug1_d,t2_drug2_d,t2_mean2))
}
}
})
End.time <- Sys.time()
End.time-Start.time
T2_Table3 <-Filter(length, T2_Table2)
T2_Table4 <- data.frame(t(sapply(T2_Table3,c)))
T2_Table4$X1 <- as.character(T2_Table4$X1)
T2_Table4$X2 <- as.character(T2_Table4$X2)
T2_Table4$X3 <- as.numeric(as.character(T2_Table4$X3))
T2_Table4$X4 <- as.numeric(as.character(T2_Table4$X4))
T2_Table4$X8 <- as.numeric(as.character(T2_Table4$X8))
T2_Table4$X5 <- as.numeric(as.character(T2_Table4$X5))
T2_Table4$X6 <- as.numeric(as.character(T2_Table4$X6))
T2_Table4$X9 <- as.numeric(as.character(T2_Table4$X9))
T2_Table4$X10 <- as.numeric(as.character(T2_Table4$X10))
T2_Table4$X11 <- as.numeric(as.character(T2_Table4$X11))
plot(T2_Table4$X3,T2_Table4$X6)
View(T2_Table4)
View(T2_Table4)
View(T2_Table4)
View(T2_Table4)
runApp('app7.R')
runApp('app7.R')
runApp('app7.R')
runApp('app7.R')
runApp('app7.R')
runApp('app7.R')
View(T2_Table4)
T2_FL_ID1 <- unique(c(as.character(T2_Table4$X1),as.character(T2_Table4$X2)))
T2_FL_ID1
View(T2_Table4)
tq <- T2_FL_ID1[2]
T2_Table5a <- T2_Table4[which(T2_Table4$X1 ==tq),c("X2","X6")]
T2_Table5b <- T2_Table4[which(T2_Table4$X2 ==tq),c("X1","X6")]
View(T2_Table5b)
T2_Table5a <- T2_Table4[which(T2_Table4$X1 ==tq | T2_Table4$X2 ==tq),c("X1","X2","X6")]
View(T2_Table5a)
View(T2_Table4)
View(T2_Table5a)
View(T2_Table4)
View(T2_Table5)
View(T2_Table4)
View(T2_Table5)
View(T2_Table5)
T2_Table4a <- T2_Table4[,c("ID","X1","X3")]
colnames(T2_Table4a) <- c("ID","Drug","DR")
View(T2_Table4)
T2_Table4$ID <- paste(as.character(T2_Table4$X1),as.character(T2_Table4$X2),sep="")
View(T2_Table4)
T2_Table4a <- T2_Table4[,c("ID","X1","X4")]
colnames(T2_Table4a) <- c("ID","Drug","DR")
T2_Table4b <- T2_Table4[,c("ID","X2","X5")]
colnames(T2_Table4b) <- c("ID","Drug","DR")
T2_Table5 <- rbind(T2_Table4a,T2_Table4b)
T2_Final2 <- data.frame()
for (t2_id in T2_FL_ID1)
{
t2_vector1 <-T2_Table5[which(T2_Table5$Drug==t2_id),]
t2_vector2 <- as.numeric(as.character(t2_vector1$DR))
t2_vector3 <- scale(t2_vector2)
#using POMS instead of z score https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4569815/#B14
t2_vector1$Z <- t2_vector3
t2_vector1$P <-(t2_vector2-min(t2_vector2))/(max(t2_vector2)-min(t2_vector2))
t2_vector1$N <- t2_vector2*t2_vector1$P
T2_Final2 <- rbind(T2_Final2,t2_vector1,stringsAsFactors=FALSE)
}
View(T2_Final2)
T2_Final3 <- cast(T2_Final2,ID~Drug,value.var=N)
library(reshape)
T2_Final3 <- cast(T2_Final2,ID~Drug,value.var=N)
View(T2_Final2)
View(T2_Table5)
View(T2_Table4)
View(T2_Table4a)
View(T2_Table5)
T2_Table4a <- T2_Table4[,c("ID","X1","X4")]
T2_Table4a$Col <- "X1"
colnames(T2_Table4a) <- c("ID","Drug","DR","Col")
T2_Table4b <- T2_Table4[,c("ID","X2","X5")]
T2_Table4b$Col <- "X2"
colnames(T2_Table4b) <- c("ID","Drug","DR","Col")
T2_Table5 <- rbind(T2_Table4a,T2_Table4b)
T2_Final2 <- data.frame()
for (t2_id in T2_FL_ID1)
{
t2_vector1 <-T2_Table5[which(T2_Table5$Drug==t2_id),]
t2_vector2 <- as.numeric(as.character(t2_vector1$DR))
t2_vector3 <- scale(t2_vector2)
#using POMS instead of z score https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4569815/#B14
t2_vector1$Z <- t2_vector3
t2_vector1$P <-(t2_vector2-min(t2_vector2))/(max(t2_vector2)-min(t2_vector2))
t2_vector1$N <- t2_vector2*t2_vector1$P
T2_Final2 <- rbind(T2_Final2,t2_vector1,stringsAsFactors=FALSE)
}
library(reshape)
T2_Final3 <- dcast(T2_Final2,ID~Drug,value.var="Col",fun.aggregate=mean)
T2_Final3 <- dcast(T2_Final2,ID~Col,value.var="Z",fun.aggregate=mean)
T2_Final3 <- dcast(T2_Final2,ID~Col,value.var="N",fun.aggregate=mean)
View(T2_Final3)
View(T2_Final4)
View(T2_Final2)
View(T2_Final2)
plot(T2_Table4$X4,T2_Table4$X5)
plot_ly(T2_Table4, x = ~X4, y = ~X5,type = 'scatter',alpha=0.7,marker = list(size = 10),
mode = 'markers',hoverinfo= 'text',text=~paste(X1," ",X2)) %>% layout(dragmode = "select")
View(T2_Table4)
View(T2_Final2)
plot_ly(T2_Table4, x = ~X3, y = ~X6,type = 'scatter',alpha=0.7,marker = list(size = 10),
mode = 'markers',hoverinfo= 'text',text=~paste(X1," ",X2)) %>% layout(dragmode = "select")
plot_ly(T2_Table4, x = ~X4, y = ~X5,type = 'scatter',alpha=0.7,marker = list(size = 10),
mode = 'markers',hoverinfo= 'text',text=~paste(X1," ",X2)) %>% layout(dragmode = "select")
View(T2_Final3)
View(T2_Table4)
T2_Table4$X12 <- as.numeric(as.character(T2_Table4$X12))
View(T2_Table4)
plot_ly(T2_Table4, x = ~X3, y = ~X12,type = 'scatter',alpha=0.7,marker = list(size = 10),
mode = 'markers',hoverinfo= 'text',text=~paste(X1," ",X2)) %>% layout(dragmode = "select")
View(T2_Table4)
#Combined Drug
t2_sig3 <- t2_sig1 +t2_sig2
t2_sig3
write.table(T2_Table4,file="data/T2_Table4.txt",sep="\t")
T2_Table_Final <- read.table(file="data/T2_Table4.txt")
View(T2_Table_Final)
plot_ly(T2_Table_Final, x = ~X3, y = ~X6,type = 'scatter',alpha=0.7,marker = list(size = 10),
mode = 'markers',hoverinfo= 'text',text=~paste(X1," ",X2)) %>% layout(dragmode = "select")
runApp('app7.R')
runApp('app7.R')
runApp('app7.R')
runApp('app7.R')
library(httr)
library(RCurl)
text <- "https://drugcomb.fimm.fi/lastupdate/serverprocessing.php?draw=2&columns[0][data]=0&columns[0][name]=&columns[0][searchable]=true&columns[0][orderable]=true&columns[0][search][value]=&columns[0][search][regex]=false&columns[1][data]=1&columns[1][name]=&columns[1][searchable]=true&columns[1][orderable]=true&columns[1][search][value]=&columns[1][search][regex]=false&columns[2][data]=2&columns[2][name]=&columns[2][searchable]=true&columns[2][orderable]=true&columns[2][search][value]=&columns[2][search][regex]=false&columns[3][data]=3&columns[3][name]=&columns[3][searchable]=true&columns[3][orderable]=true&columns[3][search][value]=&columns[3][search][regex]=false&columns[4][data]=4&columns[4][name]=&columns[4][searchable]=true&columns[4][orderable]=true&columns[4][search][value]=&columns[4][search][regex]=false&columns[5][data]=5&columns[5][name]=&columns[5][searchable]=true&columns[5][orderable]=true&columns[5][search][value]=&columns[5][search][regex]=false&columns[6][data]=6&columns[6][name]=&columns[6][searchable]=true&columns[6][orderable]=true&columns[6][search][value]=&columns[6][search][regex]=false&columns[7][data]=7&columns[7][name]=&columns[7][searchable]=true&columns[7][orderable]=true&columns[7][search][value]=&columns[7][search][regex]=false&columns[8][data]=8&columns[8][name]=&columns[8][searchable]=true&columns[8][orderable]=true&columns[8][search][value]=&columns[8][search][regex]=false&columns[9][data]=9&columns[9][name]=&columns[9][searchable]=true&columns[9][orderable]=true&columns[9][search][value]=&columns[9][search][regex]=false&order[0][column]=9&order[0][dir]=asc&start=0&length=500000&search[value]=&search[regex]=false&_=1555964882784"
text <- "https://drugcomb.fimm.fi/lastupdate/serverprocessing.php?draw=2&columns[0][data]=0&columns[0][name]=&columns[0][searchable]=true&columns[0][orderable]=true&columns[0][search][value]=&columns[0][search][regex]=false&columns[1][data]=1&columns[1][name]=&columns[1][searchable]=true&columns[1][orderable]=true&columns[1][search][value]=&columns[1][search][regex]=false&columns[2][data]=2&columns[2][name]=&columns[2][searchable]=true&columns[2][orderable]=true&columns[2][search][value]=&columns[2][search][regex]=false&columns[3][data]=3&columns[3][name]=&columns[3][searchable]=true&columns[3][orderable]=true&columns[3][search][value]=&columns[3][search][regex]=false&columns[4][data]=4&columns[4][name]=&columns[4][searchable]=true&columns[4][orderable]=true&columns[4][search][value]=&columns[4][search][regex]=false&columns[5][data]=5&columns[5][name]=&columns[5][searchable]=true&columns[5][orderable]=true&columns[5][search][value]=&columns[5][search][regex]=false&columns[6][data]=6&columns[6][name]=&columns[6][searchable]=true&columns[6][orderable]=true&columns[6][search][value]=&columns[6][search][regex]=false&columns[7][data]=7&columns[7][name]=&columns[7][searchable]=true&columns[7][orderable]=true&columns[7][search][value]=&columns[7][search][regex]=false&columns[8][data]=8&columns[8][name]=&columns[8][searchable]=true&columns[8][orderable]=true&columns[8][search][value]=&columns[8][search][regex]=false&columns[9][data]=9&columns[9][name]=&columns[9][searchable]=true&columns[9][orderable]=true&columns[9][search][value]=&columns[9][search][regex]=false&order[0][column]=9&order[0][dir]=asc&start=0&length=500000&search[value]=&search[regex]=false&_=1555964882784"
text1 <- "https://drugcomb.fimm.fi/lastupdate/serverprocessing.php?draw=2&columns[0][data]=0&columns[0][name]=&columns[0][searchable]=true&columns[0][orderable]=true&columns[0][search][value]=&columns[0][search][regex]=false&columns[1][data]=1&columns[1][name]=&columns[1][searchable]=true&columns[1][orderable]=true&columns[1][search][value]=&columns[1][search][regex]=false&columns[2][data]=2&columns[2][name]=&columns[2][searchable]=true&columns[2][orderable]=true&columns[2][search][value]=&columns[2][search][regex]=false&columns[3][data]=3&columns[3][name]=&columns[3][searchable]=true&columns[3][orderable]=true&columns[3][search][value]=&columns[3][search][regex]=false&columns[4][data]=4&columns[4][name]=&columns[4][searchable]=true&columns[4][orderable]=true&columns[4][search][value]=&columns[4][search][regex]=false&columns[5][data]=5&columns[5][name]=&columns[5][searchable]=true&columns[5][orderable]=true&columns[5][search][value]=&columns[5][search][regex]=false&columns[6][data]=6&columns[6][name]=&columns[6][searchable]=true&columns[6][orderable]=true&columns[6][search][value]=&columns[6][search][regex]=false&columns[7][data]=7&columns[7][name]=&columns[7][searchable]=true&columns[7][orderable]=true&columns[7][search][value]=&columns[7][search][regex]=false&columns[8][data]=8&columns[8][name]=&columns[8][searchable]=true&columns[8][orderable]=true&columns[8][search][value]=&columns[8][search][regex]=false&columns[9][data]=9&columns[9][name]=&columns[9][searchable]=true&columns[9][orderable]=true&columns[9][search][value]=&columns[9][search][regex]=false&order[0][column]=9&order[0][dir]=asc&start=0&length=500000&search[value]=&search[regex]=false&_=1555964882784"
raw_data <- getURL(text1)
data <- fromJSON(raw_data)
library(jsonlite)
data <- fromJSON(raw_data)
final_data <- do.call(rbind, data)
dim(final_data)
H <- final_data[1:10,1:10]
View(H)
View(H)
colnames(final_data) <- c("DrugA","DrugB","Cell_Line","CSS","S","ZIP","BLISS","LOEWE","HSA","BLOCK_ID")
View(H)
colnames(final_data) <- c("DrugA","DrugB","Cell_Line","CSS","S","ZIP","BLISS","LOEWE","HSA","BLOCK_ID")
dim(final_data)
H <- final_data[1:10,1:20]
View(t2_1)
View(H)
H <- final_data[1:10,1:20]
dim(final_data)
View(H)
final_data2 <- final_data[,1:10]
colnames(final_data2) <- c("DrugA","DrugB","Cell_Line","CSS","S","ZIP","BLISS","LOEWE","HSA","BLOCK_ID")
H <- final_data[1:10,10:20]
dim(final_data)
H <- final_data[1:10,1:19]
View(H)
View(H)
View(final_data2)
H <- final_data[1:10,1:19]
View(H)
